Seaurchin Score File(*.sus) 仕様書 v2.1
================================================================================


概要
================================================================================
susフォーマットは、bmsフォーマットをベースに例のゲームの譜面を再現できるように改変を加えたものとなっています。
互換性はほとんどありませんが、そもそもこのゲームは他と違ってノーツの長さから変わってきやがるので互換性を維持するのは無理があるというものです。
  
現段階ではLR2などが対応している譜面の制御構造には対応していません。仕方ないね。


仕様
================================================================================
* susフォーマットの規定のエンコーディングはUTF-8です。
* susフォーマットでは先頭が'#'でない行は全てコメントとみなされます。よってこのファイル自体も有効なものです。
  また、"このように"文字列リテラルの形で表されている部分は""がなくても多くの場合正常に動作しますが、わかりやすさのためにくくるべきです。
* 文字列リテラル以外の部分で大文字と小文字は区別されていません。この仕様は将来変更される可能性があります。

ヘッダ
----------------------------------------
susフォーマットで有効なヘッダは次の通りです。同じヘッダを複数記述した場合は後の
方が適用されます。

* #TITLE "Title text"
 - タイトル
* #ARTIST "Artist name"
 - アーティスト
* #DESIGNER "Score Designer"
 - 譜面製作者
* #DIFFICULTY 0~4 or "n:type"
 - 難易度
 - パラメーターには数値か文字列を指定できます。
 - 数値を指定する場合、次の対応となります。
  + 0: BASIC
  + 1: ADVANCED
  + 2: EXPERT
  + 3: MASTER
  + 4: WORLD'S END
 - 文字列を指定する場合、最初の1文字目を数値、コロンを挟んで任意の文字(列)。
 - これはWORLD'S ENDの特殊難易度(☆☆両・☆☆☆☆戻など)に対応するの記法です。
 - ☆☆☆☆戻はあれなんなんですかね
* #PLAYLEVEL 0~
 - レベルの数字
 - 任意の正の整数が設定できますが…
* #SONGID "some string"
 - 楽曲ID
 - sus独自のヘッダで、主に楽曲選択での表示を適正化するために用います。
 - 差分・発狂譜面などはもとの譜面のIDを保持するべきです。
* #WAVE "filename.wav"
 - 楽曲ファイル
 - susファイルの位置からの相対パスで指定します。
 - 現在対応しているのはWaveとOgg VorbisとMP3(のはず)です。
 - おすすめはOgg Vorbisですね。
* #WAVEOFFSET 0.00
 - 楽曲のオフセット(秒単位)
 - 正の値を指定すると譜面より遅れて再生が開始します。
* #JACKET "jacket.jpg"
 - ジャケットの画像を指定できます。
 - サイズは640x640、フォーマットはbmp/jpg/pngです。
 - WAVEと同じく相対パス。
データ
--------------------------------------------------------------------------------
* データ行は #mmmll か #mmmllx で始まり、コロンで区切って譜面データを記述します。
  mmmは小節番号(000~999)、llはレーン番号(00~zz)、xはロングレーンの識別番号(0~z)です。ショートノーツのレーンでこれを指定することはできません。

* データは1単位あたり2文字で、そのデータ行における小節の分割数はこのデータ単位の数で決定します。
* #mmm10 ~ #mmm1f
 - 地を這うショートノーツ用レーン
 - Tap Ex-Tap Flick Hell-Tap(未実装) Airが該当します。
 - データ定義
  + 00, 10, 20, ... z0 : なし。みやすさのためにI0やl0を一部に使うのもありですね。
  + 11, 12, ... 1g : Tap。
  + 21, 22, ... 2g : Ex-Tap。
  + 31, 32, ... 3g : Flick。
  + 41, 42, ... 4g : Hell-Tap。
* #mmm50 ~ #mmm5f
 - Airノーツ用レーン
 - ショートノーツレーンと別になっているということは…わかるな？
  + 11, 12, ... 1g : 上Air
  + 21, 22, ... 2g : 下Air
  + 31, 32, ... 3g : 左上Air(↖)
  + 41, 42, ... 4g : 右上Air(↗)
  + 51, 52, ... 5g : 左下Air(↙)
  + 61, 62, ... 6g : 右下Air(↘)
* #mmm20x ~ #mmm2fx : Hold用レーン
* #mmm30x ~ #mmm3fx : Slide用レーン
* #mmm40x ~ #mmm4fx : Air-Action用レーン
 - この3つは全てロング扱いです。
 - Air-Actionがなぜロングなのかは補助線の存在に理由の一端があります。
 - ノーツ定義
  + 11, ... 1g : 開始。
  + 21, ... 2g : 終了。
  + 31, ... 3g : 中継点(Slide)、Air-Action。
  + 41, ... 4g : 変曲点(Slide)。
  + 51, ... 5g : 不可視中継点。Air-Actionでやる必要性はないかも。
 - 中継点はStep、変曲点はControlという別名がありますがsusフォーマットでは関係ありません。内部表現ですが、便宜上こちらを用いて解説します。
 - Controlはロングノーツの間に任意の個数を挟むことができます。
 - StepとStepの間(開始と終了含む)にControlが存在しない場合、そのセグメントは直線変化になります。
 - Step間にいくつまでControlを挟むかですが、処理効率などを考えると多くても3つ位が限度でしょう。可能なら1つだけでどうにかしてほしいです。
 - Controlをおいた場合にどのような手法で曲線を生成するかですが、暫定的にはベジエ曲線を採用します。しかし、表現力に問題がある可能性があります。
 - 5xの定義は明示的に中継ノーツを置きたくないけどカチッっと曲げたい時に有用。うまい使い方を見つけてあげてください。
 - ロングノーツは対応をチェックします。Holdが終わる時に幅が違うとかそういうのです。まあでもチェックしてないところも多少はあります。
* #BPMll
 - BPM定義
 - これは半分データで半分ヘッダみたいなやつです。
 - #BPM01:150.00 のようにして定義します。
* #mmm08
 - BPM変更
 - これだけBMSと同じような指定方法をします(データが定義番号)。
* #mmm02
 - 拍数変更
 - 常識的に考えて p / 2^n (p, n ∈ N) の小数を指定してください。お願いします。
 - それ以外を指定してもすぐに死んだりはしませんがズレます。
 - 内部表現は1拍を192分割してるのでノーツの分割数もそれの約数になるような数を指定してください。
 - 例えば4/4拍子の小節は192 * 4 = 768tickあるので768の約数の分割に対応できます。


履歴
================================================================================
* v2.3 2017/06/18
 - PLAYLEVELの存在忘れてたよ

* v2.2 2017/06/13
 - JACKETディレティブを追加した。

* v2.1 2017/6/10
 - Airが割りと自由に付加できたほうがいいなぁとか思った。
 - あと見えない中継点がないと案外困るっぽいのでそれもついかした

* v2.0 2017/06/07
 - 全面改訂。